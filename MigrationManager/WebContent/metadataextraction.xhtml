<!DOCTYPE html>
<html xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"   
	  xmlns:p="http://primefaces.org/ui"
	  xmlns:o="http://omnifaces.org/ui"
	  xmlns:of="http://omnifaces.org/functions">
<h:head>
<meta charset="UTF-8" />
<title>IBM Migration Manager | Metadata Extraction</title>
</h:head>
<body>
	<h1>IBM Migration Manager</h1>
	<p:menubar>
        <p:submenu label="Manage Master Data" icon="ui-icon-document">
            <p:menuitem value="Manage Snapshot" url="#" icon="ui-icon-image" />
            <p:menuitem value="Manage Document" url="#" icon="ui-icon-document" />
        </p:submenu>
        <p:menuitem value="Identification" url="#" icon="ui-icon-search" />
        <p:menuitem value="Metadata Extraction" url="#" icon="ui-icon-gear" />             
	</p:menubar>
	
	<br />
	<br />
	
	<h:form id="metadataextraction">
	<table>
		<tr>
			<td>Document</td>
			<td>
				<h:selectOneMenu id="document" value="#{metadataExtraction.document}" converter="omnifaces.SelectItemsConverter">
					<f:selectItem itemLabel="Select Document" noSelectionOption="true" />
					<f:selectItems value="#{documents.documents}" />
					<p:ajax update="@this,source_location,metadata_property" />
				</h:selectOneMenu>
			</td>
		</tr>
		<tr>
			<td>Source Location</td>
			<td>
				<h:selectOneMenu id="source_location" value="#{metadataExtraction.commencePath}" converter="omnifaces.SelectItemsConverter">
					<f:selectItem itemLabel="Select Source Location" noSelectionOption="true" />
					<f:selectItems value="#{metadataExtraction.document.commencePaths}"></f:selectItems>
				</h:selectOneMenu>
			</td>
		</tr>
		<tr>
			<td>Metadata Property</td>
			<td>
				<h:selectOneMenu id="metadata_property" value="#{metadataExtraction.metadataProperty}" converter="omnifaces.SelectItemsConverter">
					<f:selectItem itemLabel="Select Metadata Property" noSelectionOption="true" />
					<f:selectItems value="#{metadataExtraction.document.metadataProperties}"></f:selectItems>
				</h:selectOneMenu>
			</td>
		</tr>
		<tr>
			<td>Use Default Rule</td>
			<td>
				<h:selectBooleanCheckbox id="useDefaultRule" value="#{metadataExtraction.useDefaultRule}">
				    <p:ajax event="change" update="metadataExtractionRules" />
				</h:selectBooleanCheckbox>
				
			</td>
		</tr>
	</table>
	
	<p:panelGrid id="metadataExtractionRules">
		<p:row rendered="#{!metadataExtraction.useDefaultRule}" >
			<p:column>
				Human Readable Rule
			</p:column>
			<p:column colspan="3">
				<h:inputTextarea value="#{metadataExtraction.humanReadableRule}" cols="60" rows="3"></h:inputTextarea>
			</p:column>
		</p:row>
		<p:row rendered="#{!metadataExtraction.useDefaultRule}" >
			<p:column>
				Regular Expression
			</p:column>
			<p:column>
				<h:inputText value="#{metadataExtraction.regex}" size="50"></h:inputText>
			</p:column>
			<p:column>
				Capturing Group
			</p:column>
			<p:column>
				<h:inputText value="#{metadataExtraction.capGroup}" size="10"></h:inputText>
			</p:column>
		</p:row>
		<p:row>
			<p:column colspan="4" style="text-align: right;">
				<p:commandButton value="Preview" action="#{metadataExtraction.preview}" ajax="true" update="preview">
				</p:commandButton>
				
				<p:commandButton value="Run and Save">
				</p:commandButton>
			</p:column>
		</p:row>
		</p:panelGrid>	
	

		
		<p:dataTable id="preview" var="identifiedDocInstance" value="#{metadataExtraction.identifiedDocInstances}">
		    <p:column headerText="File Path">
		        <h:outputText value="#{identifiedDocInstance.path}" />
		    </p:column>
		 
		    <p:column headerText="File Name">
		        <h:outputText value="#{identifiedDocInstance.name}" />
		    </p:column>
		 
		    <p:column headerText="Metadata Value">
		        <h:outputText value="#{identifiedDocInstance.metadataValue}" />
		    </p:column>
		</p:dataTable>
		
	</h:form>
</body>
</html>